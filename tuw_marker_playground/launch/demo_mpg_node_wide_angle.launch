<launch>

    <arg name="device" default="3"/>
    <arg name="show" default="false"/>
  
    <node pkg="tuw_uvc" type="wide_angle_node" name="camera"  output="screen">
      <param name="video_device" value="/dev/video$(arg device)"/>
      <param name="show_camera_image" value="$(arg show)"/>  
      <param name="camera_freeze" value="false"/>  
      <param name="convert_image" value="1"/>    
      <param name="camera_info_url" value="file://$(find tuw_uvc)/cfg/wide_angle.yml" />
      <param name="frame_id" value="camera"/>
      <param name="width" value="1600"/>
      <param name="height" value="1200"/>
    </node>

    <node pkg="tuw_ellipses" type="ellipses_node" name="ellipseMarker" output="screen">
        <param name="show_camera_image" value="true"/>
        <param name="debug" value="false"/>

        <remap from="image" to="/camera/image_raw"/>
        <remap from="camera_info" to="camera/camera_info"/>
        <remap from="markers" to="/markersEllipse"/>
        <remap from="fiducials" to="/ellipseFiducials"/>
    </node>

    <node pkg="tuw_aruco" type="aruco_node" name="arMarkerAruco" output="screen">
        <param name="marker_size" value="0.06"/>
        <param name="pose_estimation_enabled" value="true"/>
        <param name="publish_markers" value="true"/>
        <param name="publish_fiducials" value="true"/>

        <remap from="image" to="/camera/image_raw"/>
        <remap from="camera_info" to="/camera/camera_info"/>
        <remap from="markers" to="/markersAruco"/>
        <remap from="fiducials" to="/fiducialsAruco"/>
    </node>

    <node pkg="tuw_marker_pose_estimation" type="pose_estimation_node" name="arPoseEstimation" output="screen">
        <remap from="fiducials" to="/fiducialsAruco"/>
        <remap from="markers" to="/markersPoseEstimation"/>
    </node>

    <node name="rviz" pkg="rviz" type="rviz" args="-d $(find tuw_marker_pose_estimation)/rviz/demo_config_comp.rviz" />

    <!-- undistore image -->
    <group ns="camera" > 
      <node pkg="image_proc" type="image_proc" name="image_proc" />
    </group>

</launch>
